<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>趣味学习</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta name="description" content="523322.xyz - 浏览器直接运行的互动教学实验平台，涵盖物理、数学、化学、电子工程、计算机等领域的可视化模拟与演示，完全免费，无需安装，小步骤积累大知识。" />
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9474229114991789" crossorigin="anonymous"></script>
<style>
:root {
  --primary: #1a73e8;
  --primary-hover: #1557b0;
  --primary-glow: rgba(26,115,232,0.6);
  --bg: #f6f8fb;
  --card-bg: #ffffff;
  --text: #202124;
  --text-light: #5f6368;
  --border: #dadce0;
  --shadow-sm: 0 1px 2px rgba(60,64,67,.3), 0 1px 3px rgba(60,64,67,.15);
  --shadow: 0 6px 18px rgba(0,0,0,.08);
  --transition: all .25s ease;
  --search-primary: #1a73e8;
  --search-text-normal: #5f6368;
  --search-text-muted: #3c4043;
  --search-input-bg: rgba(255,255,255,0.95);
  --search-card-bg: rgba(255,255,255,0.85);
  --search-card-hover-bg: rgba(26,115,232,0.12);
  --search-border: rgba(26,115,232,0.4);
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
  background: var(--bg);
  color: var(--text);
  height: 100vh;
  overflow: hidden;
}
#layout { display: flex; height: 100vh; width: 100vw; }
#main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
#sidebar {
  width: 220px;
  background: var(--card-bg);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  box-shadow: var(--shadow-sm);
  transition: transform 0.3s ease;
  z-index: 200;
}
#logo {
  padding: 28px 20px;
  font-size: 26px;
  font-weight: 700;
  text-align: center;
  color: var(--primary);
  border-bottom: 1px solid var(--border);
}
#logo.return-mode { cursor: pointer; }
#logo.return-mode:hover { opacity: 0.85; }
#logo.return-mode::after {
  content: '返回';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: #333;
  color: #fff;
  padding: 6px 12px;
  border-radius: 6px;
  font-size: 13px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s;
}
#logo.return-mode:hover::after { opacity: 1; }
#cats {
  flex: 1;
  overflow-y: auto;
  padding: 8px 0;
}
.cat {
  padding: 10px 24px;
  cursor: pointer;
  font-size: 15px;
  color: var(--text);
  transition: var(--transition);
}
.cat:hover { background: #f1f3f4; }
.cat.active {
  background: var(--primary);
  color: #fff;
  font-weight: 600;
}
#side-bottom {
  border-top: 1px solid var(--border);
  padding: 8px 0;
}
#side-bottom div {
  padding: 10px 24px;
  cursor: pointer;
  font-size: 15px;
  color: var(--text);
  transition: var(--transition);
}
#side-bottom div:hover {
  background: #f1f3f4;
}
#overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 199; }
#hamburger {
  display: none;
  position: fixed;
  top: 18px;
  left: 18px;
  width: 32px;
  height: 24px;
  cursor: pointer;
  flex-direction: column;
  justify-content: space-between;
  z-index: 201;
}
#hamburger span { height: 4px; background: var(--text); border-radius: 2px; transition: var(--transition); }
@media (max-width: 868px) {
  #sidebar { position: fixed; top: 0; left: 0; height: 100%; transform: translateX(-100%); width: 260px; }
  #sidebar.visible { transform: translateX(0); }
  #hamburger { display: flex; }
  body.sidebar-open #overlay { display: block; }
  #ad-top { padding-left: 64px; }
}
#ad-top {
  background: var(--card-bg);
  border-bottom: 1px solid var(--border);
  padding: 10px;
  text-align: center;
  box-shadow: var(--shadow-sm);
  min-height: 70px;
}
#content { flex: 1; overflow: auto; padding: 28px; background: var(--bg); display: none; }
#search-page {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40px 20px;
}
.s-search {
  width:100%;
  max-width:960px;
  text-align:center;
}
.s-type-list {
  display:flex;
  justify-content:center;
  gap:48px;
  margin-bottom:40px;
  font-size:18px;
  font-weight:500;
}
.s-type-list label {
  cursor:pointer;
  color:var(--search-text-normal);
  padding:8px 0;
  position:relative;
  transition:all 0.3s ease;
}
.s-type-list label:hover {
  color:var(--primary);
}
.s-type-list label.active {
  color:var(--search-primary);
}
.s-type-list label.active::after {
  content:'';
  position:absolute;
  bottom:-12px;
  left:50%;
  transform:translateX(-50%);
  width:36px;
  height:4px;
  background:var(--search-primary);
  border-radius:2px;
  box-shadow:0 0 12px var(--primary-glow);
}
.super-search-fm {
  position:relative;
  display:flex;
  align-items:center;
  width:100%;
  max-width:760px;
  height:56px;
  margin:0 auto;
  background:#fff;
  border-radius:12px;
  overflow:hidden;
  box-shadow: var(--shadow-sm);
  border:1px solid var(--border);
}
.super-search-fm input {
  flex:1;
  padding:0 28px;
  font-size:19px;
  border:none;
  outline:none;
  background:transparent;
  color:#333;
}
.super-search-fm input::placeholder {
  color:#aaa;
}
.super-search-fm .submit {
  width:68px;
  height:100%;
  background:transparent;
  border:none;
  cursor:pointer;
  font-size:28px;
  color:#777;
  transition:all 0.3s;
}
.super-search-fm .submit:hover {
  color:#333;
}
.indicator {
  width:0;
  height:0;
  border-left:10px solid transparent;
  border-right:10px solid transparent;
  border-bottom:12px solid var(--search-primary);
  margin:20px auto 0;
  opacity:0;
  transition:opacity 0.3s;
  pointer-events:none;
}
.indicator.active {
  opacity:1;
}
.search-type-wrapper {
  position:relative;
  margin-top:40px;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  padding-bottom:10px;
}
.search-group {
  display:none;
}
.search-group.active {
  display:block;
}
.search-type {
  display:flex;
  justify-content:center;
  flex-wrap:nowrap;
  gap:20px;
  min-width:min-content;
  padding:0 20px;
  white-space:nowrap;
}
.search-type label {
  cursor:pointer;
  padding:10px 26px;
  background:var(--search-card-bg);
  border:1px solid var(--search-border);
  border-radius:30px;
  color:var(--search-text-muted);
  font-size:16px;
  font-weight:500;
  transition:all 0.3s ease;
  backdrop-filter:blur(12px);
  flex-shrink:0;
}
.search-type label:hover {
  background:var(--search-card-hover-bg);
  color:var(--search-primary);
  border-color:var(--search-primary);
  box-shadow:0 0 16px var(--primary-glow);
}
.search-type label.selected {
  background:var(--search-card-hover-bg);
  color:var(--search-primary);
  border-color:var(--search-primary);
  box-shadow:0 0 16px var(--primary-glow);
  font-weight:600;
}
.search-type-wrapper::-webkit-scrollbar {
  height:6px;
}
.search-type-wrapper::-webkit-scrollbar-thumb {
  background:rgba(26,115,232,0.4);
  border-radius:3px;
}
.category-title { font-size: 32px; font-weight: 600; margin-bottom: 16px; }
.sub-title {
  font-size: 20px;
  color: var(--primary);
  margin: 36px 0 14px;
  padding-bottom: 6px;
  border-bottom: 2px solid var(--primary);
}
.links {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 16px;
  padding: 0 8px;
}
.card {
  display: flex;
  align-items: center;
  padding: 12px;
  background: var(--card-bg);
  border-radius: 12px;
  text-decoration: none;
  color: inherit;
  height: 110px;
  box-shadow: var(--shadow-sm);
  transition: var(--transition);
  overflow: hidden;
  position: relative;
  cursor: pointer;
}
.card:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 18px rgba(0,0,0,0.14);
}
.card img {
  width: 48px;
  height: 48px;
  min-width: 48px;
  object-fit: contain;
  background: var(--bg);
  border-radius: 8px;
  padding: 4px;
}
.text { margin-left: 12px; overflow: hidden; flex: 1; }
.name { font-size: 15px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.desc { font-size: 13px; color: var(--text-light); margin-top: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.credit {
  position: absolute;
  bottom: 8px;
  right: 12px;
  font-size: 12px;
  color: #888;
}
.ad-box {
  margin: 40px 0;
  padding: 24px;
  background: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 14px;
  text-align: center;
  box-shadow: var(--shadow-sm);
}
#iframe-content {
  width: 100%;
  height: 100%;
  border: none;
}
</style>
</head>
<body>
<div id="layout">
  <div id="sidebar">
    <div id="logo" onclick="backToPrevious()">导　航</div>
    <div id="cats">
      <div style="padding:20px;text-align:center;color:#999;font-size:14px;">加载中...</div>
    </div>
    <div id="side-bottom">
      <div onclick="loadExternal('/submit.html')">网站提交</div>
      <div onclick="loadExternal('/privacy.html')">隐私政策</div>
      <div onclick="loadExternal('/links.html')">友情链接</div>
      <div onclick="loadExternal('/about.html')">关于本站</div>
    </div>
  </div>
  <div id="main">
    <div id="overlay" onclick="toggleSidebar()"></div>
    <div id="hamburger" onclick="toggleSidebar()">
      <span></span><span></span><span></span>
    </div>
    <div id="ad-top">
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9474229114991789" data-ad-slot="1234567890" data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>
    <div id="search-page">
      <div class="s-search">
        <div class="s-type-list">
          <label class="active" data-id="group-a">常用</label>
          <label data-id="group-b">搜索</label>
          <label data-id="group-c">工具</label>
          <label data-id="group-d">社区</label>
          <label data-id="group-e">生活</label>
          <label data-id="group-f">求职</label>
        </div>
        <form class="super-search-fm" onsubmit="event.preventDefault(); doSearch();">
          <input type="text" id="search-text" placeholder="百度一下，你就知道" autocomplete="off">
          <button class="submit" type="button">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <circle cx="11" cy="11" r="8"/>
              <line x1="21" y1="21" x2="16.65" y2="16.65"/>
            </svg>
          </button>
        </form>
        <div class="indicator" id="indicator"></div>
        <div class="search-type-wrapper">
          <div class="search-group group-a active">
            <div class="search-type">
              <label for="type-baidu" class="selected">百度</label>
              <label for="type-bing">必应</label>
              <label for="type-google">谷歌</label>
              <label for="type-anaconda">软件</label>
              <label for="type-pubmed">文献</label>
            </div>
          </div>
          <div class="search-group group-b">
            <div class="search-type">
              <label for="type-baidu1" class="selected">百度</label>
              <label for="type-google1">谷歌</label>
              <label for="type-360">360</label>
              <label for="type-sogo">搜狗</label>
              <label for="type-bing1">必应</label>
              <label for="type-sm">神马</label>
            </div>
          </div>
          <div class="search-group group-c">
            <div class="search-type">
              <label for="type-br" class="selected">权重查询</label>
              <label for="type-links">友链检测</label>
              <label for="type-whois">域名信息查询</label>
              <label for="type-ping">PING 检测</label>
              <label for="type-404">死链检测</label>
              <label for="type-ciku">关键词挖掘</label>
            </div>
          </div>
          <div class="search-group group-d">
            <div class="search-type">
              <label for="type-zhihu" class="selected">知乎</label>
              <label for="type-wechat">微信</label>
              <label for="type-weibo">微博</label>
              <label for="type-douban">豆瓣</label>
            </div>
          </div>
          <div class="search-group group-e">
            <div class="search-type">
              <label for="type-taobao1" class="selected">淘宝</label>
              <label for="type-jd">京东</label>
              <label for="type-xiachufang">下厨房</label>
              <label for="type-xiangha">香哈菜谱</label>
              <label for="type-12306">12306</label>
              <label for="type-qunar">去哪儿</label>
            </div>
          </div>
          <div class="search-group group-f">
            <div class="search-type">
              <label for="type-zhaopin" class="selected">智联招聘</label>
              <label for="type-51job">前程无忧</label>
              <label for="type-lagou">拉钩网</label>
              <label for="type-liepin">猎聘网</label>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="content"></div>
  </div>
</div>

<script>
const API = '/api/data';
const DEF_ICON = '/icons/gray.png';
let currentEngine = "https://www.baidu.com/s?wd=";
let data = [];
let xmlDoc = null;
const categoryCache = new Map();
let lastState = 'search'; // 'search', 'category', 'experiment'
let lastCategoryData = null;

function getDomain(url) {
  try {
    const h = new URL(url).hostname;
    return h.startsWith('www.') ? h.slice(4) : h;
  } catch {
    return 'example.com';
  }
}

function isInternalLink(url) {
  if (typeof url !== 'string') return false;
  const trimmed = url.trim();
  return trimmed.startsWith('/') && !/^https?:\/\//i.test(trimmed);
}

document.getElementById('cats').innerHTML = '<div style="padding:20px;text-align:center;color:#999;font-size:14px;">加载中...</div>';
fetch(API)
  .then(r => r.text())
  .then(text => {
    xmlDoc = new DOMParser().parseFromString(text, 'text/xml');
    data = [...xmlDoc.querySelectorAll('category')].map(c => ({
      name: c.getAttribute('name'),
      subs: [...c.querySelectorAll('subcategory')].map(s => ({
        name: s.getAttribute('name'),
        links: [...s.querySelectorAll('link')].map(l => ({
          name: l.getAttribute('name'),
          url: l.getAttribute('url'),
          desc: l.getAttribute('desc') || '',
          icon: l.getAttribute('icon') || '',
          author: l.getAttribute('author') || '',
          contributors: l.getAttribute('contributors') || ''
        }))
      }))
    }));
    renderCats();
    backToSearch();
  })
  .catch(err => {
    console.error('加载分类失败:', err);
    document.getElementById('cats').innerHTML = '<div style="padding:20px;text-align:center;color:#c00;font-size:14px;">加载失败，请检查 /api/data 是否可用</div>';
  });

function renderCats() {
  const box = document.getElementById('cats');
  box.innerHTML = '';
  data.forEach((cat, idx) => {
    const el = document.createElement('div');
    el.className = 'cat';
    el.textContent = cat.name;
    el.onclick = () => {
      document.querySelectorAll('.cat').forEach(c => c.classList.remove('active'));
      el.classList.add('active');
      loadCategory(idx);
    };
    box.appendChild(el);
  });
}

function loadCategory(idx) {
  lastState = 'category';
  if (categoryCache.has(idx)) {
    showCategory(categoryCache.get(idx));
    return;
  }
  const node = xmlDoc.querySelectorAll('category')[idx];
  const catData = {
    name: node.getAttribute('name'),
    subs: [...node.querySelectorAll('subcategory')].map(s => ({
      name: s.getAttribute('name'),
      links: [...s.querySelectorAll('link')].map(l => ({
        name: l.getAttribute('name'),
        url: l.getAttribute('url'),
        desc: l.getAttribute('desc') || '',
        icon: l.getAttribute('icon') || '',
        author: l.getAttribute('author') || '',
        contributors: l.getAttribute('contributors') || ''
      }))
    }))
  };
  categoryCache.set(idx, catData);
  lastCategoryData = catData;
  showCategory(catData);
}

function showCategory(cat) {
  document.getElementById('search-page').style.display = 'none';
  const cont = document.getElementById('content');
  cont.style.display = 'block';
  cont.innerHTML = `<div class="category-title">${cat.name}</div>
  <div class="ad-box"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9474229114991789" data-ad-slot="9876543210" data-ad-format="auto"></ins></div>`;
  (adsbygoogle = window.adsbygoogle || []).push({});
  cat.subs.forEach(sub => {
    if (!sub.links.length) return;
    cont.innerHTML += `<div class="sub-title">${sub.name}</div><div class="links"></div>`;
    const linksBox = cont.lastElementChild;
    sub.links.forEach(link => {
      const a = document.createElement('a');
      a.className = 'card';
      a.href = 'javascript:void(0)';
      a.onclick = function(e) {
        e.preventDefault();
        if (isInternalLink(link.url)) {
          loadExperiment(link.url);
        } else {
          window.open(link.url, '_blank', 'noopener');
        }
      };

      const img = document.createElement('img');
      const favicon = link.icon.trim() || DEF_ICON;
      img.src = favicon;
      img.onerror = () => { img.src = DEF_ICON; };

      const textDiv = document.createElement('div');
      textDiv.className = 'text';
      textDiv.innerHTML = `<div class="name">${link.name}</div><div class="desc">${link.desc}</div>`;

      let creditText = '';
      if (link.author) creditText += `作者：${link.author}`;
      if (link.contributors) creditText += (creditText ? '　' : '') + `贡献者：${link.contributors}`;
      if (!creditText) creditText = '作者：523322';
      const credit = document.createElement('div');
      credit.className = 'credit';
      credit.textContent = creditText;

      a.append(img, textDiv, credit);
      linksBox.appendChild(a);
    });
  });
  document.getElementById('logo').classList.add('return-mode');
  closeSidebarOnMobile();
}

function loadExperiment(url) {
  lastState = 'experiment';
  document.getElementById('search-page').style.display = 'none';
  const cont = document.getElementById('content');
  cont.innerHTML = `<iframe id="iframe-content" src="${url}" allowfullscreen></iframe>`;
  cont.style.padding = '0';
  cont.style.overflow = 'hidden';
  document.getElementById('logo').classList.add('return-mode');
  document.querySelectorAll('.cat').forEach(c => c.classList.remove('active'));
  closeSidebarOnMobile();
}

function loadExternal(url) {
  loadExperiment(url);
  lastState = 'experiment';
}

function backToPrevious() {
  if (lastState === 'experiment') {
    if (lastCategoryData) {
      showCategory(lastCategoryData);
      lastState = 'category';
    } else {
      backToSearch();
    }
  } else if (lastState === 'category') {
    backToSearch();
  }
}

function backToSearch() {
  lastState = 'search';
  lastCategoryData = null;
  document.getElementById('content').style.display = 'none';
  document.getElementById('content').innerHTML = '';
  document.getElementById('content').style.padding = '28px';
  document.getElementById('search-page').style.display = 'flex';
  document.getElementById('logo').classList.remove('return-mode');
  document.querySelectorAll('.cat').forEach(c => c.classList.remove('active'));
  closeSidebarOnMobile();
}

function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('visible');
  document.body.classList.toggle('sidebar-open');
}

function closeSidebarOnMobile() {
  if (window.innerWidth <= 868) {
    document.getElementById('sidebar').classList.remove('visible');
    document.body.classList.remove('sidebar-open');
  }
}

/* 完整搜索功能 */
document.body.insertAdjacentHTML('beforeend', `
<div style="display:none;">
  <input hidden type="radio" name="type" checked id="type-baidu" value="https://www.baidu.com/s?wd=" data-placeholder="百度一下，你就知道">
  <input hidden type="radio" name="type" id="type-bing" value="https://cn.bing.com/search?q=" data-placeholder="微软 Bing 搜索">
  <input hidden type="radio" name="type" id="type-google" value="https://www.google.com/search?q=" data-placeholder="谷歌搜索">
  <input hidden type="radio" name="type" id="type-anaconda" value="https://anaconda.org/search?q=" data-placeholder="Anaconda 软件搜索">
  <input hidden type="radio" name="type" id="type-pubmed" value="https://pubmed.ncbi.nlm.nih.gov/?term=" data-placeholder="PubMed 搜索/文章标题/关键字">
  <input hidden type="radio" name="type" id="type-baidu1" value="https://www.baidu.com/s?wd=" data-placeholder="百度一下，你就知道">
  <input hidden type="radio" name="type" id="type-google1" value="https://www.google.com/search?q=" data-placeholder="谷歌搜索">
  <input hidden type="radio" name="type" id="type-360" value="https://www.so.com/s?q=" data-placeholder="360 好搜">
  <input hidden type="radio" name="type" id="type-sogo" value="https://www.sogou.com/web?query=" data-placeholder="搜狗搜索">
  <input hidden type="radio" name="type" id="type-bing1" value="https://cn.bing.com/search?q=" data-placeholder="微软 Bing 搜索">
  <input hidden type="radio" name="type" id="type-sm" value="https://yz.m.sm.cn/s?q=" data-placeholder="UC 移动端搜索">
  <input hidden type="radio" name="type" id="type-br" value="https://rank.chinaz.com/all/" data-placeholder="请输入网址(不带 https://)">
  <input hidden type="radio" name="type" id="type-links" value="https://link.chinaz.com/" data-placeholder="请输入网址(不带 https://)">
  <input hidden type="radio" name="type" id="type-whois" value="https://who.is/whois/" data-placeholder="请输入网址(不带 https://)">
  <input hidden type="radio" name="type" id="type-ping" value="https://ping.chinaz.com/" data-placeholder="请输入网址(不带 https://)">
  <input hidden type="radio" name="type" id="type-404" value="https://tool.chinaz.com/Links/?DAddress=" data-placeholder="请输入网址(不带https://)">
  <input hidden type="radio" name="type" id="type-ciku" value="https://www.ciku5.com/s?wd=" data-placeholder="请输入关键词">
  <input hidden type="radio" name="type" id="type-zhihu" value="https://www.zhihu.com/search?type=content&q=" data-placeholder="知乎">
  <input hidden type="radio" name="type" id="type-wechat" value="https://weixin.sogou.com/weixin?type=2&query=" data-placeholder="微信">
  <input hidden type="radio" name="type" id="type-weibo" value="https://s.weibo.com/weibo/" data-placeholder="微博">
  <input hidden type="radio" name="type" id="type-douban" value="https://www.douban.com/search?q=" data-placeholder="豆瓣">
  <input hidden type="radio" name="type" id="type-taobao1" value="https://s.taobao.com/search?q=" data-placeholder="淘宝">
  <input hidden type="radio" name="type" id="type-jd" value="https://search.jd.com/Search?keyword=" data-placeholder="京东">
  <input hidden type="radio" name="type" id="type-xiachufang" value="https://www.xiachufang.com/search/?keyword=" data-placeholder="下厨房">
  <input hidden type="radio" name="type" id="type-xiangha" value="https://www.xiangha.com/so/?q=caipu&s=" data-placeholder="香哈菜谱">
  <input hidden type="radio" name="type" id="type-12306" value="https://www.12306.cn/?" data-placeholder="12306">
  <input hidden type="radio" name="type" id="type-qunar" value="https://www.qunar.com/?" data-placeholder="去哪儿">
  <input hidden type="radio" name="type" id="type-zhaopin" value="https://sou.zhaopin.com/jobs/searchresult.ashx?kw=" data-placeholder="智联招聘">
  <input hidden type="radio" name="type" id="type-51job" value="https://search.51job.com/?" data-placeholder="前程无忧">
  <input hidden type="radio" name="type" id="type-lagou" value="https://www.lagou.com/jobs/list_" data-placeholder="拉钩网">
  <input hidden type="radio" name="type" id="type-liepin" value="https://www.liepin.com/zhaopin/?key=" data-placeholder="猎聘网">
</div>
`);

document.querySelectorAll('input[name="type"]').forEach(radio => {
  radio.addEventListener("change", () => {
    currentEngine = radio.value;
    const ph = radio.getAttribute("data-placeholder") || "输入关键字搜索";
    document.getElementById("search-text").placeholder = ph;
  });
});

function doSearch() {
  const kw = document.getElementById("search-text").value.trim();
  if (!kw) return;
  window.open(currentEngine + encodeURIComponent(kw), "_blank");
}

document.getElementById("search-text").addEventListener("keydown", e => {
  if (e.key === "Enter") {
    e.preventDefault();
    doSearch();
  }
});

document.querySelector(".super-search-fm .submit").addEventListener("click", doSearch);

document.querySelectorAll('.s-type-list label').forEach(label => {
  label.addEventListener('click', () => {
    document.querySelectorAll('.s-type-list label').forEach(l => l.classList.remove('active'));
    label.classList.add('active');
    const groupId = label.getAttribute('data-id');
    document.querySelectorAll('.search-group').forEach(g => g.classList.remove('active'));
    document.querySelector(`.search-group.${groupId}`).classList.add('active');
    document.getElementById('search-text').value = '';
    const firstLabel = document.querySelector(`.search-group.${groupId} .search-type label:first-child`);
    if (firstLabel) {
      document.querySelectorAll('.search-type label').forEach(l => l.classList.remove('selected'));
      firstLabel.classList.add('selected');
      const radioId = firstLabel.getAttribute('for');
      const radio = document.getElementById(radioId);
      if (radio) {
        radio.checked = true;
        currentEngine = radio.value;
        document.getElementById('search-text').placeholder = radio.getAttribute("data-placeholder") || "输入关键字搜索";
      }
      updateIndicator(firstLabel);
    }
  });
});

document.querySelectorAll('.search-type label').forEach(label => {
  label.addEventListener('click', () => {
    document.querySelectorAll('.search-type label').forEach(l => l.classList.remove('selected'));
    label.classList.add('selected');
    const radioId = label.getAttribute('for');
    const radio = document.getElementById(radioId);
    if (radio) {
      radio.checked = true;
      currentEngine = radio.value;
      document.getElementById('search-text').placeholder = radio.getAttribute("data-placeholder") || "输入关键字搜索";
    }
    updateIndicator(label);
  });
});

function updateIndicator(label) {
  const indicator = document.getElementById('indicator');
  const rect = label.getBoundingClientRect();
  const wrapperRect = document.querySelector('.search-type-wrapper').getBoundingClientRect();
  const offsetLeft = rect.left + rect.width / 2 - wrapperRect.left;
  indicator.style.marginLeft = `${offsetLeft}px`;
  indicator.classList.add('active');
}

window.addEventListener('load', () => {
  const firstLabel = document.querySelector('.search-group.group-a .search-type label:first-child');
  if (firstLabel) updateIndicator(firstLabel);
});
</script>
</body>
</html>
